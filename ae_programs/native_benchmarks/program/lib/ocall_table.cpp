// this file is generated by lib/gen_ocall_stub.py script
#if NOSGX_PAN
static void *ocall_table[36] = {
    (void *) sgx_clock,
    (void *) sgx_time,
    (void *) sgx_localtime,
    (void *) sgx_gmtime,
    (void *) sgx_mktime,
    (void *) sgx_gettimeofday,
    (void *) sgx_puts,
    (void *) sgx_open,
    (void *) sgx_close,
    (void *) sgx_read,
    (void *) sgx_write,
    (void *) sgx_lseek,
    (void *) sgx_socket,
    (void *) sgx_bind,
    (void *) sgx_connect,
    (void *) sgx_listen,
    (void *) sgx_accept,
    (void *) sgx_fstat,
    (void *) sgx_send,
    (void *) sgx_recv,
    (void *) sgx_sendto,
    (void *) sgx_recvfrom,
    (void *) sgx_gethostname,
    (void *) sgx_getaddrinfo,
    (void *) sgx_getenv,
    (void *) sgx_getsockname,
    (void *) sgx_getsockopt,
    (void *) sgx_getservbyname,
    (void *) sgx_getprotobynumber,
    (void *) sgx_setsockopt,
    (void *) sgx_htons,
    (void *) sgx_htonl,
    (void *) sgx_ntohs,
    (void *) sgx_ntohl,
    (void *) sgx_signal,
    (void *) sgx_shutdown,
};
#else
static void *ocall_table[36] = {
    (void *) clock,
    (void *) time,
    (void *) localtime,
    (void *) gmtime,
    (void *) mktime,
    (void *) gettimeofday,
    (void *) puts,
    (void *) open,
    (void *) close,
    (void *) read,
    (void *) write_nosgx,
    (void *) lseek,
    (void *) socket,
    (void *) bind,
    (void *) connect,
    (void *) listen,
    (void *) accept,
    (void *) fstat,
    (void *) send,
    (void *) recv,
    (void *) sendto,
    (void *) recvfrom,
    (void *) gethostname,
    (void *) getaddrinfo,
    (void *) getenv,
    (void *) getsockname,
    (void *) getsockopt,
    (void *) getservbyname,
    (void *) getprotobynumber,
    (void *) setsockopt,
    (void *) htons,
    (void *) htonl,
    (void *) ntohs,
    (void *) ntohl,
    (void *) signal,
    (void *) shutdown,
};
#endif

// TODO: check if it breaks the calling ABI
void do_sgx_ocall() {
    __asm__ __volatile__ (
        "mov (%0, %%r14, 8), %%r14\n"
        "call *%%r14\n"
    ::"r" (ocall_table));
}
